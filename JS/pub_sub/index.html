<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>订阅发布者模式</title>
    <style>
    html,body{
        height: 100%;
    }
    </style>
</head>
<body>
    <script>
        // Listener 收听者 callback， 发布者  document.body
        // 注册事件 点击后做回调
    // document.body.addEventListener('click',function(){
    //     alert('111');
    // },false);  
    // document.body.addEventListener('click',function(){
    //     alert('222');
    // },false);   
    // document.body.addEventListener('click',function(){
    //     alert('333');
    // },false); 

    let xwt = {
        yz:100,
        name:'徐文韬',
    }; // 发布者

    xwt.peopleList = []; //存储订阅者的地方

    xwt.listen = function(fn){
        this.peopleList.push(fn);
    }

    xwt.trigger = function(){
        for(var i= 0,fn;fn=this.peopleList[i++];){
            fn.call(this,'今晚有空');
        }
    }

    xwt.listen(function(msg){
        console.log(`想${this.name} ${msg}唱歌`);
    })
    xwt.listen(function(msg){
        console.log(`想${this.name} ${msg}打牌`);
    })
    xwt.listen(function(msg){
        console.log(`想${this.name} ${msg}吃饭`);
    })
    console.log(xwt.peopleList.length);
    //先形成他们之间的关系 

    setTimeout(() => {
        xwt.trigger();
    }, 3000);

    </script>
</body>
</html>